<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DC Fast Charging Rig</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>

  <!-- Fullscreen Launch Screen -->
  <div id="launch-screen" class="launch-screen">
    <h1>DC Fast Charging Rig</h1>
    <button id="startButton" onclick="startApp()">Start Simulation</button>
  </div>

  <!-- Main App Layout -->
  <div class="main-layout" id="app" style="display: none;">
    <!-- Left Section: Controls and Modes -->
    <div class="left-panel">
      <h1>DC Fast Charging Rig</h1>

      <div class="controls" id="discharge-controls">
        <button id="discharge-btn" onclick="toggleRelay('discharge')" class="discharge-btn">Discharge</button>
      </div>

      <div class="mode-buttons">
        <button onclick="selectMode('M1')" class="mode-btn">Mode M1</button>
        <button onclick="selectMode('M2')" class="mode-btn">Mode M2</button>
        <button onclick="selectMode('M3')" class="mode-btn">Mode M3</button>
        <button onclick="selectMode('M4')" class="mode-btn">Mode M4</button>
      </div>
    </div>

    <!-- Right Section: Info Panels + Graph -->
    <div class="right-panel">
      <div class="info-panels">
        <div class="info-block" id="grid-info">
          <h2>Grid Info</h2>
          <p>Voltage: <span id="grid-voltage"></span></p>
          <p>Current: <span id="grid-current"></span></p>
          <p>Frequency: <span id="grid-frequency"></span></p>
          <p>Power: <span id="grid-power"></span></p>
        </div>

        <div class="info-block" id="charger-info">
          <h2>Charger Info</h2>
          <p>Voltage: <span id="charger-voltage"></span></p>
          <p>Current: <span id="charger-current"></span></p>
          <p>Power: <span id="charger-power"></span></p>
          <p><strong>Charge Rate (C):</strong> <span id="charger-c-rate">0.25</span></p>
        </div>

        <div class="info-block" id="battery-info">
          <h2>Battery Info</h2>
          <p>Voltage: <span id="battery-voltage"></span></p>
          <p>Current: <span id="battery-current"></span></p>
          <p>Power: <span id="battery-power"></span></p>
          <p>SOC: <span id="battery-soc"></span>%</p>
          <p>SOH: <span id="battery-soh"></span>%</p>
          <p>Cycles: <span id="battery-cycles"></span></p>
          <p>Status: <span id="battery-status"></span></p>
          <p>Time Elapsed: <span id="battery-time"></span></p>
          <p>Temperature: <span id="battery-temp"></span>&deg;C</p>
        </div>
      </div>

      <!-- Chart Section -->
      <div class="chart-container">
        <canvas id="batteryChart"></canvas>
      </div>

      <!-- Export Button -->
      <button id="export-btn" onclick="exportData()" class="export-btn">Export Graph Data</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="script.js"></script>
  <script>
    function startApp() {
      const elem = document.documentElement;
      if (elem.requestFullscreen) {
        elem.requestFullscreen();
      } else if (elem.webkitRequestFullscreen) {
        elem.webkitRequestFullscreen();
      } else if (elem.msRequestFullscreen) {
        elem.msRequestFullscreen();
      }

      // Hide launch screen, show app layout
      document.getElementById("launch-screen").style.display = "none";
      document.getElementById("app").style.display = "flex";

      // Start in default mode
      selectMode("M1");
    }
  </script>
</body>
</html>
